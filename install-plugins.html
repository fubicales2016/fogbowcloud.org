<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>fogbow</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://www.fogbowcloud.org/theme/css/bootstrap.css">
    <link rel="stylesheet" href="http://www.fogbowcloud.org/theme/css/font-awesome.min.css">
    
    <link rel="apple-touch-icon" sizes="57x57" href="http://www.fogbowcloud.org/theme/img/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://www.fogbowcloud.org/theme/img/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://www.fogbowcloud.org/theme/img/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="http://www.fogbowcloud.org/theme/img/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="http://www.fogbowcloud.org/theme/img/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="http://www.fogbowcloud.org/theme/img/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="http://www.fogbowcloud.org/theme/img/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="http://www.fogbowcloud.org/theme/img/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="http://www.fogbowcloud.org/theme/img/icons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="http://www.fogbowcloud.org/theme/img/icons/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="http://www.fogbowcloud.org/theme/img/icons/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="http://www.fogbowcloud.org/theme/img/icons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="http://www.fogbowcloud.org/theme/img/icons/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="http://www.fogbowcloud.org/theme/img/icons/favicon-32x32.png" sizes="32x32">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="http://www.fogbowcloud.org/theme/img/icons/mstile-144x144.png">
   </head>
  <body>
    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a href="../" class="navbar-brand"></a>
          <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <ul id="navbar-main" class="nav navbar-nav navbar-right">
          <li >
            <a href="http://www.fogbowcloud.org/rational.html">Understand it</a>
          </li>
          <li class="active">
            <a href="http://www.fogbowcloud.org/install-general.html">Install it</a>
          </li>
          <li >
            <a href="http://www.fogbowcloud.org/fogbow-cli.html">Use it</a>
          </li>
          <li><a href="https://github.com/fogbow/" target="_blank">Contribute</a></li>
          <li><a href="http://www.fogbowcloud.org/contact.html">Contact us</a></li>
        </ul>
      </div>
    </div>
     <div class="container">
      <div class="bs-docs-section">
    <div class="bs-docs-section">
    <div class="row">
      <div class="col-lg-4">
      	<br>
        <ul class="nav nav-pills nav-stacked" style="max-width: 300px;">
            <li >
            	<a href="install-general">Get started</a>
            </li>
            <li >
            	<a href="install-manager">Manager</a>
            </li>
            <li class="active">
            	<a href="install-plugins">Plugins</a>
            </li>
            <li >
            	<a href="install-rendezvous">Rendezvous</a>
            </li>
            <li >
            	<a href="install-reverse-tunnel">Reverse Tunnel</a>
            </li>
            <li >
            	<a href="install-opportunism">Opportunism</a>
            </li>
        </ul>
      </div>
      <div class="col-lg-8 page-content">
      	<h1>Plugins</h1>
<p>The manager component was designed to be agnostic to the underlying cloud technology. There is an interoperability plugin layer between this component and the cloud, in a sense that plugins are responsible for translating fogbow's requests to what the underlying cloud understands. Plugins are instantiated via reflection, and fully configured via the configuration file. Currently, fogbow makes available some plugins, and new ones can be contributed by the fogbow developers' community.</p>
<p>There are four different categories of interoperability plugins: the <strong>Image Storage Plugins</strong>, the <strong>Identity Plugins</strong>, the <strong>Authorization Plugins</strong> and the <strong>Compute Plugins</strong>.</p>
<p>In addition to interoperability plugins, there are also behavioural plugins. These are used to specify the way each fogbow manager should act when serving clients' requests.</p>
<h2>Image Storage Plugin</h2>
<p>New requests arrive at the Fogbow Manager describe, among other things, an image that should be used by instances spawned. This image is a federation-wide id and potentially not recognized at the underlying cloud level as a proper image identifier. Image Storage plugins do the job of parsing such ids and translating them to valid local image identifiers.</p>
<p>Those plugins could also benefit from the fact that they are called when new requests arrive, and, for instance, perform dynamic upload of images fetched from VM marketplaces to the underlying cloud, which is exactly what the <code>EgiImageStoragePlugin</code> does.</p>
<h3>Configure</h3>
<div class="highlight"><pre><span class="c"># Image Storage Plugin class</span>
<span class="nv">image_storage_class</span><span class="o">=</span>org.fogbowcloud.manager.core.plugins.egi.EgiImageStoragePlugin

<span class="c"># Base URL of the VM marketplace, if not provided, </span>
<span class="c"># the system will still work with images provided statically </span>
<span class="nv">image_storage_egi_base_url</span><span class="o">=</span>http://vms.fogbowcloud.org/~base/ 

<span class="c"># If the VM marketplace requires authentication, a Java Keystore can be provided</span>
<span class="nv">image_storage_egi_keystore_path</span><span class="o">=</span>/path/to/keystore
<span class="nv">image_storage_egi_keystore_password</span><span class="o">=</span>passpass

<span class="c"># Temporary folder where images from the VM marketplace are stored</span>
<span class="nv">image_storage_egi_tmp_storage</span><span class="o">=</span>/tmp/

<span class="c"># Static mapping of global image ids to local image ids</span>
image_storage_static_fogbow-linux-x86<span class="o">=</span>55d938ef-57d1-44ea-8155-6036d170780a 
image_storage_static_fogbow-ubuntu-1204<span class="o">=</span>81765250-a4e4-440d-a215-43c9c0849120
</pre></div>


<p>As you can see above, you can statically configure the fogbow manager with as many image as you want. Therefore, each manager can be configured with different images and/or same images but different names. Currently, fogbow uses global image identifiers in requests. For example, if the user requests for one instance of <strong>image-ubuntu</strong> in cloud A and that cloud does not have such image, the request is passed on to another cloud, cloud B, and will be fulfilled only if the manager in cloud B was configured with <strong>image-ubuntu</strong> or it previously fetched such image from a VM marketplace. A list of the most commom image names used by current fogbow installations follows on:</p>
<ul>
<li><strong>fogbow-linux-x86</strong>: Cirros 0.3.3 image; cirros as username; and cubswin:) as password</li>
<li><strong>fogbow-ubuntu-12.04-with-java</strong>: Ubuntu 12.04 image (standard ubuntu cloud image with java); ubuntu as username; SSH login via publickey.</li>
</ul>
<p>Furthermore, Fogbow also expects that all images configured at manager have <strong>cloud-init</strong> working properly.</p>
<h2>Identity Plugin</h2>
<p>The Identity Plugin is responsible for getting and authenticating tokens for local and federation cloud users. The Local Identity Provider and the Federation Identity Provider must be the same when the authentication is done at the Local Cloud Identity Provider. Otherwise, you can configure different plugins for local and federation identity providers. </p>
<p>Make sure to have the identity plugin ports opened in your network firewall configuration, to allow authentication by federation users from outside the local network, If you are using Keystone Identity Plugin, open the port 5000, or the port 2633 for OpenNebula Identity Plugin.</p>
<h3>Configure</h3>
<p>As you can see at the <a href="http://www.fogbowcloud.org/install-manager">Manager Install Guide</a>, when the installation is done, rename the file <code>manager.conf.example</code> to <code>manager.conf</code>. You need to configure the Identity Plugin according to the Identity Provider you are using. The following sections go through the configuration for the Identity Plugins that come along with the Fogbow Manager. You can configure different plugins for local and federation identity providers.</p>
<p><strong>Keystone Identity Plugin</strong> </p>
<div class="highlight"><pre><span class="c"># Local Identity plugin class</span>
<span class="nv">local_identity_class</span><span class="o">=</span>org.fogbowcloud.manager.core.plugins.openstack.KeystoneIdentityPlugin

<span class="c"># Cloud Identity endpoint</span>
<span class="nv">local_identity_url</span><span class="o">=</span>http://localhost:5000

<span class="c"># Federation Identity plugin class</span>
<span class="nv">federation_identity_class</span><span class="o">=</span>org.fogbowcloud.manager.core.plugins.openstack.KeystoneIdentityPlugin

<span class="c"># Federation identity endpoint</span>
<span class="nv">federation_identity_url</span><span class="o">=</span>http://localhost:5000

<span class="c"># Proxy account for remote requests @ the local identity provider </span>
<span class="nv">local_proxy_account_user_name</span><span class="o">=</span>fogbow
<span class="c"># Password of such account</span>
<span class="nv">local_proxy_account_password</span><span class="o">=</span>fogbow
<span class="c"># Tenant of such account</span>
<span class="nv">local_proxy_account_tenant_name</span><span class="o">=</span>demo
</pre></div>


<p><strong>OpenNebula Identity Plugin</strong></p>
<div class="highlight"><pre><span class="c"># Local Identity plugin class</span>
<span class="nv">local_identity_class</span><span class="o">=</span>org.fogbowcloud.manager.core.plugins.opennebula.OpenNebulaIdentityPlugin

<span class="c"># Cloud identity endpoint</span>
<span class="nv">local_identity_url</span><span class="o">=</span>http://localhost:2633/RPC2

<span class="c"># Federation Identity plugin class</span>
<span class="nv">federation_identity_class</span><span class="o">=</span>org.fogbowcloud.manager.core.plugins.opennebula.OpenNebulaIdentityPlugin

<span class="c"># Cloud identity endpoint</span>
<span class="nv">federation_identity_url</span><span class="o">=</span>http://localhost:2633/RPC2

<span class="c"># Proxy account for remote requests @ the local identity provider </span>
<span class="nv">local_proxy_account_user_name</span><span class="o">=</span>fogbow
<span class="c"># Password of such account</span>
<span class="nv">local_proxy_account_password</span><span class="o">=</span>fogbow
</pre></div>


<p><strong>X509 Plugin</strong></p>
<div class="highlight"><pre><span class="c"># Local Identity plugin class</span>
<span class="nv">local_identity_class</span><span class="o">=</span>org.fogbowcloud.manager.core.plugins.x509.X509IdentityPlugin

<span class="c"># Directory where are the certificates of Certificate Authorities (CA). </span>
<span class="c"># They are certificates that you trust.</span>
<span class="nv">x509_ca_dir_path</span><span class="o">=</span>/path/to/ca/directory
</pre></div>


<p><strong>VOMs Plugin</strong></p>
<div class="highlight"><pre><span class="c"># Local Identity plugin class</span>
<span class="nv">local_identity_class</span><span class="o">=</span>org.fogbowcloud.manager.core.plugins.voms.VomsIdentityPlugin

<span class="c"># Directory where are the VOMS server information. </span>
<span class="c"># List of voms servers in order to issue a proxy. </span>
<span class="c"># Default : &quot;~/.glite/vomses&quot;</span>
<span class="nv">path_vomses</span><span class="o">=</span>/path/vomes

<span class="c"># Directory where are the certificates of Certificate Authorities (CA). </span>
<span class="c"># They are certificates that you trust.</span>
<span class="c"># You need to have the certificate, CRL (certificate revocation list), </span>
<span class="c"># info, namespaces and signing_policy files for each CA.</span>
<span class="c"># These files need to have read permission grant to the user that runs</span>
<span class="c"># the fogbow manager</span>
<span class="c"># Default : &quot;/etc/grid-security/certificates&quot;</span>
<span class="nv">path_trust_anchors</span><span class="o">=</span>/path/trust/anchors

<span class="c"># Directory where are the certificates of VOMS that you trust.</span>
<span class="c"># Default : &quot;/etc/grid-security/vomsdir&quot;</span>
<span class="nv">path_vomsdir</span><span class="o">=</span>/path/voms/dir
</pre></div>


<p>Note: The VOMS Plugin uses the <a href="https://github.com/italiangrid/voms-api-java">VOMS Api Java</a>. This API only works with JREs provided by Oracle with the <a href="http://stackoverflow.com/questions/6481627/java-security-illegal-key-size-or-default-parameters">unlimited strength file installed</a>.</p>
<h2>Compute Plugin</h2>
<p>The Compute Plugin is responsible for requesting, getting, and deleting instances at the local cloud. Different plugins can require different information depending on their implementation. Fogbow manager assumes that all cloud users have quota defined and all information at <code>manager.conf</code> file are correct. If not, the behaviour of federation may not be the expected.</p>
<h3>Configure</h3>
<p>As you can see at the <a href="http://www.fogbowcloud.org/install-manager">Manager Install Guide</a>, after installation move the file <code>manager.conf.example</code> to <code>manager.conf</code>. You need to add the compute plugin contents according to plugin that will be used. These examples show the required properties for plugins already available on fogbowcloud project. </p>
<p><strong>OpenStack OCCI Compute Plugin</strong></p>
<div class="highlight"><pre><span class="c"># Compute plugin class</span>
<span class="nv">compute_class</span><span class="o">=</span>org.fogbowcloud.manager.core.plugins.openstack.OpenStackComputePlugin

<span class="c"># Cloud OCCI endpoint</span>
<span class="nv">compute_occi_url</span><span class="o">=</span>http://localhost:8182

<span class="c"># Cloud v2 compute endpoint</span>
<span class="nv">compute_openstack_v2api_url</span><span class="o">=</span>http://localhost:8182

<span class="c"># Associating local cloud flavors to fogbow flavors</span>
<span class="c"># Small flavor</span>
<span class="nv">compute_occi_flavor_small</span><span class="o">=</span>m1-small

<span class="c"># Medium flavor</span>
<span class="nv">compute_occi_flavor_medium</span><span class="o">=</span>m1-medium

<span class="c"># Large flavor</span>
<span class="nv">compute_occi_flavor_large</span><span class="o">=</span>m1-large

<span class="c"># OS Cloud Scheme</span>
<span class="nv">compute_occi_os_scheme</span><span class="o">=</span>http://schemas.openstack.org/template/os#

<span class="c"># Instance Cloud Scheme</span>
<span class="nv">compute_occi_instance_scheme</span><span class="o">=</span>http://schemas.openstack.org/compute/instance#

<span class="c"># Resource Cloud Scheme</span>
<span class="nv">compute_occi_resource_scheme</span><span class="o">=</span>http://schemas.openstack.org/template/resource#

<span class="c"># Network ID (This property is required only if user project has more </span>
<span class="c"># than one network available)</span>
<span class="c"># Example:</span>
<span class="nv">compute_occi_network_id</span><span class="o">=</span>ea51ed0c-0e8a-448d-8202-c79777109ffe
</pre></div>


<p><strong>OpenStack Nova V2 Compute Plugin</strong></p>
<div class="highlight"><pre><span class="c"># Plugin class</span>
<span class="nv">compute_class</span><span class="o">=</span>org.fogbowcloud.manager.core.plugins.openstack.OpenStackNovaV2ComputePlugin

<span class="c"># Nova V2 API URL</span>
<span class="nv">compute_novav2_url</span><span class="o">=</span>http://localhost:8774

<span class="c"># Small Flavour Identifier</span>
<span class="nv">compute_novav2_flavor_small</span><span class="o">=</span>1

<span class="c"># Medium Flavour Identifier</span>
<span class="nv">compute_novav2_flavor_medium</span><span class="o">=</span>2

<span class="c"># Large Flavour Identifier</span>
<span class="nv">compute_novav2_flavor_large</span><span class="o">=</span>3

<span class="c"># Network id (This property is required only if user project has more </span>
<span class="c"># than one network available)</span>
<span class="nv">compute_novav2_network_id</span><span class="o">=</span>ea51ed0c-0e8a-448d-8202-c79777109ffe
</pre></div>


<p><strong>OpenNebula Compute Plugin</strong></p>
<div class="highlight"><pre><span class="c"># Compute plugin class</span>
<span class="nv">compute_class</span><span class="o">=</span>org.fogbowcloud.manager.core.plugins.opennebula.OpenNebulaComputePlugin

<span class="c"># Cloud opennebula compute endpoint</span>
<span class="nv">compute_one_url</span><span class="o">=</span>http://localhost:2633/RPC2

<span class="c"># Associating properties flavors to fogbow flavors</span>
<span class="c"># Small flavor</span>
<span class="nv">compute_one_flavor_small</span><span class="o">={</span><span class="nv">mem</span><span class="o">=</span>128, <span class="nv">cpu</span><span class="o">=</span>1<span class="o">}</span>

<span class="c"># Medium flavor</span>
<span class="nv">compute_one_flavor_medium</span><span class="o">={</span><span class="nv">mem</span><span class="o">=</span>256, <span class="nv">cpu</span><span class="o">=</span>2<span class="o">}</span>

<span class="c"># Large flavor</span>
<span class="nv">compute_one_flavor_large</span><span class="o">={</span><span class="nv">mem</span><span class="o">=</span>512, <span class="nv">cpu</span><span class="o">=</span>4<span class="o">}</span>

<span class="c"># Network ID to be used for instances</span>
<span class="nv">compute_one_network_id</span><span class="o">=</span>1

<span class="c"># Settings used by ONE compute plugin to register new images in the cloud</span>
<span class="c"># ID of datastore to register the image</span>
<span class="nv">compute_one_datastore_id</span><span class="o">=</span>1
<span class="c"># To register a new image, the image file needs to be in the some machine where ONE is running</span>
<span class="c"># If the fogbow manager is running in a different machine, set the SSH properties to transfer the image</span>
<span class="c"># Or if the fogbow manager is in the same machine, leave it blank</span>
<span class="nv">compute_one_ssh_host</span><span class="o">=</span>127.0.0.1
<span class="nv">compute_one_ssh_port</span><span class="o">=</span>22
<span class="nv">compute_one_ssh_username</span><span class="o">=</span>fogbow
<span class="c"># The SSH try to access using private key, set the path to ssh id_rsa file</span>
<span class="nv">compute_one_ssh_key_file</span><span class="o">=</span>/home/fogbow/.ssh/id_rsa
<span class="c"># Set the directory to copy images in remote host</span>
<span class="nv">compute_one_ssh_target_temp_folder</span><span class="o">=</span>/tmp/images
</pre></div>


<h2>Authorization Plugin</h2>
<p>The Authorization Plugin tells whether a given user (with a proper authenticated token) is able to create requests in the Federation. </p>
<h3>Configure</h3>
<p>The <strong>federation_authorization_class</strong> property must be set to a Authorization Plugin implementation. The Fogbow Manager comes with a single implementation that simply authorizes any user/token.</p>
<p><strong>Allow All Authorization Plugin</strong></p>
<div class="highlight"><pre><span class="c"># Federation Authorization plugin class</span>
<span class="c"># Example </span>
<span class="nv">federation_authorization_class</span><span class="o">=</span>org.fogbowcloud.manager.core.plugins.common.AllowAllAuthorizationPlugin
</pre></div>
      </div>
    </div>
    </div>
      </div>
    </div>
    
    <footer class="footer">
      <div class="container">
        <div class="row">
      	  <div class="col-lg-12">
      	    <ul class="list-inline">
      	      <li class="pull-right"><a href="#top">Back to top</a></li>
      	      <li><a href="http://blog.fogbowcloud.org"target="_blank">Blog</a></li>
      	      <li><a href="https://github.com/fogbow/" target="_blank">GitHub</a></li>
      	      <li><a href="http://build.fogbowcloud.org" target="_blank">Build status</a></li>
      	    </ul>
      	    <p>Code released under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html" target="_blank">Apache License Version 2.0</a>.</p>
      	    <p>Based on <a href="http://getbootstrap.com" target="_blank" rel="nofollow">Bootstrap</a>. Icons from <a href="http://fortawesome.github.io/Font-Awesome/" target="_blank" rel="nofollow">Font Awesome</a>. Web fonts from <a href="http://www.google.com/webfonts" target="_blank" rel="nofollow">Google</a>.</p>
      	  </div>
        </div>
      </div>

    </footer>

    <footer class="below-footer">
      <div class="container">
      <div class="row">

      <div class="col-lg-4">
          <a href="http://ec.europa.eu/index_en.htm" target="_blank" rel="nofollow"><img src="http://www.eubrazilcloudconnect.eu/sites/default/files/eu.jpg"></a>
          <a href="http://www.mcti.gov.br/" target="_blank" rel="nofollow"><img src="http://www.eubrazilcloudconnect.eu/sites/default/files/fin_min_ciencia.png"></a>
          <a href="http://www.cnpq.br/" target="_blank" rel="nofollow"><img src="http://www.eubrazilcloudconnect.eu/sites/default/files/cnpq.png"></a>
          <a href="http://www.finep.gov.br/" target="_blank" rel="nofollow"><img src="http://www.finep.gov.br/imagens/logo_novo.jpg" height="28"></a>
      </div>

      <div class="col-lg-8">
        <p>
          Fogbow is partially funded by CNPq/Brazil and the European Commission through the <a href="http://www.eubrazilcloudconnect.eu" target="_blank" rel="nofollow">EUBrazilCC</a> project, and by FINEP/Brazil through the <a href="http://www.lncc.br/departamentos/projetosconsultar.php?vMenu=&Idt_Projeto=587&projeto=3&vCabecalho=pesq&vTitulo=lncc&vDepto=&idt_responsavel=&vAno=2014&idt_linha_pesquisa=" target="_blank" rel="nofollow">CICN</a> project.
        </p>
      </div>

      </div>
    </div>
    </footer>



  </body>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-63282618-1', 'auto');
    ga('send', 'pageview');
  </script>
</html>